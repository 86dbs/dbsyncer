<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org" lang="zh-CN">

<div th:fragment="content">
    <div class="form-group">
        <label class="col-sm-2 control-label">帐号 <strong class="driverVerifcateRequired">*</strong></label>
        <div class="col-sm-4">
            <input class="form-control" name="username" type="text" maxlength="32" dbsyncer-valid="require" placeholder="root" th:value="${connector?.config?.username}"/>
        </div>
        <label class="col-sm-2 control-label">密码 <strong class="driverVerifcateRequired">*</strong></label>
        <div class="col-sm-4 ">
            <input class="form-control" name="password" type="password" maxlength="32" dbsyncer-valid="require"
                   th:value="${connector?.config?.password}"/>
        </div>
    </div>
    <div class="form-group">
        <label class="col-sm-2 control-label">URL <strong class="driverVerifcateRequired">*</strong></label>
        <div class="col-sm-10">
            <textarea name="url" class="form-control dbsyncer_textarea_resize_none" maxlength="1024"
                      dbsyncer-valid="require" rows="5"
                      th:text="${connector?.config?.url}?:'jdbc:mysql://127.0.0.1:3306/test?rewriteBatchedStatements=true&amp;useUnicode=true&amp;characterEncoding=UTF8&amp;serverTimezone=Asia/Shanghai&amp;useSSL=false&amp;verifyServerCertificate=false&amp;autoReconnect=true&amp;failOverReadOnly=false'"></textarea>
        </div>
    </div>

    <!-- SQL配置__开始 -->
    <div class="sqlTableList" th:with="sqlTableList=${connector?.config?.sqlTables}">
        <!-- 已添加的SQL配置 -->
        <div class="form-group">
            <label class="col-sm-2 control-label">SQL表</label>
            <div class="col-sm-10">
                <select id="sqlTableSelect" name="sqlTableSelect" class="form-control select-control">
                    <option th:each="sqlTable,state:${sqlTableList}" th:value="${sqlTable?.sql}" th:text="${sqlTable?.table}" />
                </select>
            </div>
        </div>

        <!-- 默认配置_开始 -->
        <div th:if="${#lists.isEmpty(sqlTableList)}">
            <div class="form-group">
                <label class="col-sm-2 control-label">主表</label>
                <div class="col-sm-4">
                    <input class="form-control" name="table" type="text" maxlength="32" th:value="USER"/>
                </div>
                <div class="col-sm-6 text-right">
                    <button id="addSqlTableBtn" type="button" class="btn btn-primary">
                        <span class="fa fa-plus"></span>添加(0)
                    </button>
                </div>
            </div>
            <div class="form-group">
                <label class="col-sm-2 control-label">SQL</label>
                <div class="col-sm-10">
                    <textarea name="sql" class="sql form-control dbsyncer_textarea_resize_none" maxlength="8192" rows="10">SELECT T1.* FROM USER T1</textarea>
                </div>
            </div>
            <div class="form-group">
                <div class="col-sm-6"></div>
                <div class="col-sm-6 text-right">
                    <a href="javascript:beautifySql();"><span class="fa fa-magic fa-1x fa-flip-horizontal dbsyncer_pointer"
                                                              title="美化SQL"></span>美化SQL</a>
                </div>
            </div>
        </div>

        <!-- 渲染配置_开始 -->
        <div th:if="${not #lists.isEmpty(sqlTableList)}" th:each="sqlTable,state : ${sqlTableList}">
            <div class="form-group">
                <label class="col-sm-2 control-label">主表</label>
                <div class="col-sm-4">
                    <input class="form-control" name="table" type="text" maxlength="32" th:value="${sqlTable?.table}"/>
                </div>
                <div class="col-sm-6 text-right">
                    <button id="addSqlTableBtn" type="button" class="btn btn-primary">
                        <span class="fa fa-plus"></span>添加([[${sqlTableList?.size()} ?: 0]])
                    </button>
                </div>
            </div>
            <div class="form-group">
                <label class="col-sm-2 control-label">SQL</label>
                <div class="col-sm-10">
                    <textarea name="sql" class="sql form-control dbsyncer_textarea_resize_none" maxlength="8192" rows="10" th:text="${sqlTable?.sql}"></textarea>
                </div>
            </div>
            <div class="form-group">
                <div class="col-sm-6"></div>
                <div class="col-sm-6 text-right">
                    <a href="javascript:beautifySql();"><span class="fa fa-magic fa-1x fa-flip-horizontal dbsyncer_pointer"
                                                              title="美化SQL"></span>美化SQL</a>
                </div>
            </div>
        </div>
    </div>
    <!-- SQL配置__结束 -->

    <script type="text/javascript">
        $(function () {
            // 初始化select插件
            initSelectIndex($(".select-control"), 1);
        })
    </script>
</div>

</html>