<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org" lang="zh-CN">

<div th:fragment="content">
    <!-- 转换配置标题 -->
    <p><i class="fa fa-magic text-primary"></i> 转换配置</p>

    <!-- 第一行：转换、目标源表字段 -->
    <div class="grid grid-cols-4">
        <!-- 转换 -->
        <div class="form-item">
            <label class="form-label">转换</label>
            <select id="convertOperator" class="form-control">
                <option th:value="${c?.code}" th:text="${c?.name}" th:argNum="${c?.argNum}" th:each="c,state : ${convert}"/>
            </select>
        </div>

        <!-- 目标源表字段 -->
        <div class="form-item">
            <label class="form-label">目标源表字段</label>
            <select id="convertTargetField" class="form-control">
                <!-- 目标源表公共字段 -->
                <option th:if="${tableGroup} == null"
                        th:each="c,s:${mapping?.targetColumn}"
                        th:value="${c?.name}"
                        th:text="${c?.name} +' (' + ${c?.typeName} +')'" />
                <!-- 目标源表字段 -->
                <option th:each="c,s:${tableGroup?.targetTable?.column}"
                        th:value="${c?.name}"
                        th:text="${c?.name} +' (' + ${c?.typeName} +')'" />
            </select>
        </div>

        <div class="form-item">
            <label class="form-label">参数</label>
            <input class="form-control convertArg" type="text" maxlength="50" placeholder="参数" />
        </div>

        <div class="form-item">
            <label class="form-label">参数</label>
            <input class="form-control convertArg" type="text" maxlength="50" placeholder="参数" />
        </div>
    </div>

    <!-- 第二行：参数输入框和添加按钮 -->
    <div class="form-actions mt-4">
        <button id="convertAdd" class="btn btn-info">
            <i class="fa fa-plus"></i> 添加
        </button>
    </div>

    <!-- 转换列表表格 -->
    <table id="convertTable" class="table">
        <thead>
            <tr>
                <th>转换</th>
                <th>目标源表字段</th>
                <th>参数</th>
                <th>操作</th>
            </tr>
        </thead>
        <tbody id="convertList">
            <!-- Mapping convert -->
            <tr th:if="${tableGroup} == null" th:each="f,s:${mapping?.convert}">
                <td>
                    <span class="dbsyncer-tag dbsyncer-tag-primary">[[${f?.convertName}]]</span>
                </td>
                <td>[[${f?.name}]]</td>
                <td style="word-break: break-all;">[[${f?.args}]]</td>
                <td style="text-align: center;">
                    <a class="convertDelete"
                       style="color: var(--danger-color); cursor: pointer; font-size: 16px;"
                       title="删除">
                        <i class="fa fa-trash-o"></i>
                    </a>
                </td>
            </tr>
            <!-- TableGroup convert -->
            <tr th:each="f,s:${tableGroup?.convert}">
                <td>
                    <span class="dbsyncer-tag dbsyncer-tag-primary">[[${f?.convertName}]]</span>
                </td>
                <td>[[${f?.name}]]</td>
                <td style="word-break: break-all;">[[${f?.args}]]</td>
                <td style="text-align: center;">
                    <a class="convertDelete"
                       style="color: var(--danger-color); cursor: pointer; font-size: 16px;"
                       title="删除">
                        <i class="fa fa-trash-o"></i>
                    </a>
                </td>
            </tr>
        </tbody>
    </table>

    <!-- 隐藏表单值 -->
    <div class="hidden">
        <input id="convert" name="convert" class="form-control" type="text"/>
    </div>

</div>
</html>