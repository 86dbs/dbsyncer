<!DOCTYPE html>
<html lang="zh-CN"
      xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">

<div th:fragment="content">
    <div class="grid grid-cols-2">
        <div class="form-item">
            <label class="form-label">主机<strong class="text-primary">*</strong></label>
            <div class="form-control-area">
                <input class="form-control" name="host" type="text" maxlength="100" required placeholder="127.0.0.1"
                       th:value="${connector?.config?.host}?: '127.0.0.1'"/>
            </div>
        </div>
        <div class="form-item">
            <label class="form-label">端口<strong class="text-primary">*</strong></label>
            <div class="form-control-area">
                <input class="form-control" name="port" type="number" maxlength="64" required placeholder="5432"
                       th:value="${connector?.config?.port}?: '5432'"/>
            </div>
        </div>
        <div class="form-item">
            <label class="form-label">用户名<strong class="text-primary">*</strong></label>
            <div class="form-control-area">
                <input class="form-control" required maxlength="32" name="username" placeholder="postgres"
                       th:value="${connector?.config?.username}" type="text"/>
            </div>
        </div>
        <div class="form-item">
            <label class="form-label">密码<strong class="text-primary">*</strong></label>
            <div class="form-control-area">
                <input class="form-control" required maxlength="64" name="password" placeholder="请输入密码"
                       type="password" th:value="${connector?.config?.password}"/>
            </div>
        </div>

        <div class="form-item">
            <label class="form-label">数据库名<strong class="text-primary">*</strong></label>
            <div class="form-control-area">
                <input class="form-control" required maxlength="64" name="database" placeholder="请输入数据库名"
                       type="text" th:value="${connector?.config?.database}?: 'postgres'"/>
            </div>
        </div>
    </div>

    <div class="grid grid-cols-2 mt-5">
        <div class="form-item">
            <label class="form-label">删除slot<i aria-hidden="true" class="fa fa-question-circle"
                                                 title="增量同步，停止驱动自动删除Slot"></i></label>
            <div class="form-control-area">
                <label class="form-switch">
                    <input name="dropSlotOnClose"
                           th:checked="${#maps.isEmpty(connector?.config?.extInfo) or connector?.config?.extInfo?.dropSlotOnClose eq 'true'}"
                           type="checkbox"/>
                    <span class="switch-track">
                        <span class="switch-option switch-option-on">Yes</span>
                        <span class="switch-option switch-option-off">No</span>
                        <span class="switch-thumb"></span>
                    </span>
                </label>
            </div>
        </div>
        <div class="form-item">
            <label class="form-label">插件</label>
            <select class="form-control" id="pluginName" name="pluginName">
                <option value="pgoutput" th:selected="${connector?.config?.extInfo?.pluginName eq 'pgoutput'}">
                    pgoutput
                </option>
                <option value="test_decoding"
                        th:selected="${connector?.config?.extInfo?.pluginName eq 'test_decoding'}">test_decoding
                </option>
            </select>
        </div>

        <div class="form-item">
            <label class="form-label">最大连接数<strong class="text-primary">*</strong></label>
            <div class="form-control-area">
                <input class="form-control" name="maxActive" type="number" required min="1" max="512"
                       th:value="${connector?.config?.maxActive}?:64" placeholder="默认64"/>
            </div>
        </div>

        <div class="form-item">
            <label class="form-label">有效期(毫秒)<strong class="text-primary">*</strong></label>
            <div class="form-control-area">
                <input class="form-control" name="keepAlive" type="number" required min="10000" max="120000"
                       th:value="${connector?.config?.keepAlive}?:60000" placeholder="默认60000"/>
            </div>
        </div>
    </div>

    <div class="grid mt-5">
        <div class="form-item">
            <label class="form-label">连接参数</label>
            <div class="form-control-area">
                <textarea name="properties" class="form-control" maxlength="1024" rows="5"
                          th:text="${connector?.config?.propertiesText} ?: 'ssl=false&stringtype=unspecified&binaryTransfer=true&loginTimeout=10&connectTimeout=30'"></textarea>
            </div>
        </div>
    </div>

    <div class="grid mt-5">
        <div class="form-item">
            <label class="form-label">驱动</label>
            <div class="form-control-area">
                <input class="form-control" name="driverClassName" readonly="true"
                       th:value="${connector?.config?.driverClassName} ?: 'org.postgresql.Driver'" type="text"/>
            </div>
        </div>
    </div>

    <script>
        $(document).ready(function () {
            initSelect($('#pluginName'));
        });
    </script>
</div>

</html>