<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org" lang="zh-CN">

<div th:fragment="content">
    <div class="form-grid-2">
        <div class="form-item">
            <label class="form-label">
                监听路径<i class="fa fa-question-circle" title="监听的文件路径"></i>
                <strong class="text-primary">*</strong>
            </label>
            <div class="form-control-area">
                <input class="form-control" name="fileDir" type="text" maxlength="512" required placeholder="/soft" th:value="${connector?.config?.fileDir}?:'/soft'"/>
            </div>
        </div>
        <div class="form-item">
            <label class="form-label">分割符<strong class="text-primary">*</strong></label>
            <div class="form-control-area">
                <input class="form-control" name="separator" type="text" maxlength="512" required placeholder="|" th:value="${connector?.config?.separator}?:'|'"/>
            </div>
        </div>
    </div>

    <div class="form-grid-1">
        <div class="form-item">
            <label class="form-label">
                Schema<i class="fa fa-question-circle" title="支持10种字段类型。name字段名, typeName类型名称, type类型编码, pk是否为主键"></i>
                <strong class="text-primary">*</strong>
            </label>
            <div class="form-control-area">
                <div style="text-align: right; margin-bottom: 8px;">
                    <a href="javascript:format();" class="btn btn-link">
                        <span class="fa fa-magic fa-flip-horizontal" title="美化"></span> 美化
                    </a>
                </div>
                <textarea id="schema" name="schema" class="form-control" maxlength="4096" required rows="20" th:text="${connector?.config?.schema}"></textarea>
            </div>
        </div>
    </div>

    <script type="text/javascript">
        function format() {
            const $text = $("#schema");
            if ("" == $text.text()) {
                const data = [
                    {
                        "fileName": "test.unl",
                        "separator": "|",
                        "fields": [
                            {
                                "name": "id",
                                "typeName": "integer",
                                "type": 4,
                                "pk": true
                            },
                            {
                                "name": "name",
                                "typeName": "string",
                                "type": 12
                            },
                            {
                                "name": "count",
                                "typeName": "long",
                                "type": -5
                            },
                            {
                                "name": "type",
                                "typeName": "short",
                                "type": 5
                            },
                            {
                                "name": "money",
                                "typeName": "float",
                                "type": 6
                            },
                            {
                                "name": "score",
                                "typeName": "double",
                                "type": 8
                            },
                            {
                                "name": "status",
                                "typeName": "boolean",
                                "type": -7
                            },
                            {
                                "name": "create_date",
                                "typeName": "date",
                                "type": 91
                            },
                            {
                                "name": "time",
                                "typeName": "time",
                                "type": 92
                            },
                            {
                                "name": "update_time",
                                "typeName": "timestamp",
                                "type": 93
                            }
                        ]
                    }
                ];
                $text.val(JSON.stringify(data, null, 4));
                return;
            }
            $text.val(JSON.stringify(JSON.parse($text.text()), null, 4));
        }

        $(function () {
            format();
        })
    </script>
</div>

</html>